# ðŸš— Used Car Price Prediction â€“ Advanced Ensemble ML Project

## ðŸ“Œ Project Overview
This project delivers a high-performance, end-to-end Machine Learning solution to predict used car prices. Moving beyond basic regression, I implemented a **Tuned Voting Ensemble** (Extra Trees, Random Forest, and CatBoost) and deployed it via an interactive **Streamlit** web application featuring cascading filters.

### Key Highlights:
- **Advanced Ensemble:** A "Wisdom of the Crowd" approach using three top-tier models for a balanced, low-variance prediction.
- **Cascading UI:** Real-time dependent dropdowns (Manufacturer â†’ Category â†’ Model) for a premium user experience.
- **Production Grade:** Custom Scikit-Learn transformers and compatibility wrappers designed for **Python 3.13** and **Scikit-Learn 1.5.2+**.

---

## ðŸ§  Smart Feature Engineering
The data was enhanced with domain-specific logic to capture price drivers more effectively:

- **Mileage Intensity:** A custom feature calculating `Mileage / (Age + 1)`. This differentiates between a 2-year-old "workhorse" and a 10-year-old "garage queen" with the same mileage.
- **Log-Target Transformation:** Training on `log1p(Price)` to handle the skewed distribution of car prices, significantly reducing errors on high-end luxury vehicles.
- **Frequency Encoding:** Handles high-cardinality features like `Manufacturer` and `Model` by mapping them to their market frequency, avoiding the dimensionality explosion of One-Hot Encoding.



---

## ðŸ› ï¸ Pipeline & Preprocessing
The model processes 17 distinct features through a modular **`ColumnTransformer`** pipeline:

- **Numerical:** Age, Mileage, Engine Volume, Levy, Cylinders, Airbags, **Mileage_Intensity**.
- **Categorical:** Manufacturer, Model, Category, Fuel type, Gearbox, Drive wheels, Color.
- **Binary/Ordinal:** Leather interior, **Turbo Engine**.



---

## ðŸ¤– Model Architecture: The "Tuned Trio"
The final prediction is generated by a **Voting Regressor** that averages the results of three optimized models:

1. **Extra Trees Regressor:** Excellent at handling noisy data and reducing variance.
2. **Random Forest Regressor:** The gold standard for stable, robust tabular data performance.
3. **CatBoost Regressor:** Specialized in handling categorical relationships with high precision.

### ðŸ“Š Performance Comparison
| Model | MAE | RÂ² Score |
|------|-------------------|------|
| Linear Regression | ~$8,903 | 0.23 |
| XGBoost (Tuned) | ~$4,942 | 0.67 |
| Lasso Regression | ~$11,375 | -0.137 |
| Linear Regression | ~$8,918 | 0.234 |
| Ridge Regression | ~$8,854 | 0.285 |
| Gradient Boosting | ~$6,485 | 0.535 |
| LightGBM | ~$5,052 | 0.706 |
| CatBoost | ~$4,926 | 0.720 |
| Random Forest | ~$4,092 | 0.731 |
| Extra Trees | ~$3,783 | 0.776 |
| **Final Tuned Voting Ensemble** | **~$3,930** | **0.765** |

---

## ðŸ’» Tech Stack
- **Languages:** Python 3.13
- **ML Frameworks:** Scikit-Learn (v1.5.2), CatBoost, XGBoost
- **Data Tools:** Pandas, NumPy
- **Deployment:** Streamlit
- **Serialization:** Joblib / Pickle

> **Note:** Included a custom `CatBoostRegressorWrapper` to solve the `__sklearn_tags__` attribute error found in Scikit-Learn 1.6+ and Python 3.13.

---

## ðŸš€ How to Run locally
1. **Clone the repository:**
   ```bash
   git clone [https://github.com/sumeet-016/Car-Price-Prediction.git](https://github.com/sumeet-016/Car-Price-Prediction.git)
---

## ðŸš€ Future Work & Deployment
### Planned Enhancements
- Error analysis by price segments  
- Further hyperparameter tuning  
- Enhanced feature importance visualization  

### Deployment (Planned)
- Deployment using **Streamlit**
- Interactive UI for price prediction  
- This section will be updated once deployed  

---

## ðŸ§° Tech Stack
- Python  
- Pandas, NumPy  
- Scikit-learn, XGBoost  
- Git & GitHub  

---

## ðŸ“Œ Key Takeaways
- Built an end-to-end ML pipeline  
- Followed industry-standard validation practices  
- Prioritized stability and interpretability  

---

## ðŸ‘¤ Author
**Sumeet Kumar Pal**  
Aspiring Data Analyst / Machine Learning Enthusiast
